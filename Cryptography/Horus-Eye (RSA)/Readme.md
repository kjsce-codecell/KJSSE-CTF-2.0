# Horus-Eye (RSA)

**Description**: Lord Voldemort has encrypted a secret message! Use your magic (and math) to factorize and decrypt it before it's too late.

**File 1**: [flag.enc](./files/flag.enc)  
**File 2**: [mykey.pem](./files/mykey.pem)  

## Solution

### Step 1: Extracting `n` and `e`
The `.pem` file contains the public key. We can extract the modulus (`n`) and the public exponent (`e`) using the RSA Cipher tool at [dcode.fr](https://www.dcode.fr/rsa-cipher).<br>
<br>n = `31973912565930840183966476557514486967105734963490863850242883813184363077890247373353346311197244652164393947531225033913089540524508960337859521594971267299801046318823852855678220562983993746120365799161402319433119943409550637861054248792884967164024537194083317326043002215575735008275047537805378975239548031416843476640326890142850615245392184058602194672466707234505010060517043706542794833490218200030153606086208410372554126103395033388764862282497594446045727336858065181330686078548554317618028148145081341511574658757428258020937703703371498976906228288914164074403171127516885244682134581893201619939353`<br>
e = `65537`

### Step 2: Factorizing `n`
Using [factordb.com](http://factordb.com/), we can factorize `n` into its prime components `p` and `q`.
<br>p = `178745372323502486648250292259547731882497740383375470271211389647426545774563379174721012328179536228902849348335785753
064892185470437557630965689434906006707353711580986987058256416961588222214934672164128275598047618962235958689419772153
936553146483744909335380089416800887458777762511622721462283374422847`<br>
q = `178879666367321797306889097888593237682016817784428274816313280688426535150744336100663738258433399579931125463230993781
941673394549068668770856405985346219071828327791826313541995835825389300114134241321223681884355027322999626363153646031
059388028375162129135057969840272058758742209553531971251667497682599`

### Step 3: Calculating `d`
Once we have `p` and `q`, we can compute the private exponent `d` using the RSA Cipher tool at [dcode.fr](https://www.dcode.fr/rsa-cipher).
<br>d = `15068042321112867526462984702974425591331013387054874803771174551325191169272934222286923429838517190016285564940444102909894722967170594321296234561555878214662790722139778986642993150247351066556716018540670318075162266386987067615830148984058657107601779624323103828598167804874446125556171982317151069628795881730766508507050086546488486168255147054654869215742344835655651209464741536693683879495214132253161676792000042242056493381821767191198597680361989631398023277123334976217395497331984975242984969749389536074903910847363637405250941578574379399670896086484802141962360839364494811248232660593270356391813`

### Step 4: Decrypting the Flag
Now that we have `n` and `d`, we can use [RsaCtfTool](https://github.com/RsaCtfTool/RsaCtfTool) to decrypt `flag.enc`:

```bash
python3 RsaCtfTool.py --private -n 31973912565930840183966476557514486967105734963490863850242883813184363077890247373353346311197244652164393947531225033913089540524508960337859521594971267299801046318823852855678220562983993746120365799161402319433119943409550637861054248792884967164024537194083317326043002215575735008275047537805378975239548031416843476640326890142850615245392184058602194672466707234505010060517043706542794833490218200030153606086208410372554126103395033388764862282497594446045727336858065181330686078548554317618028148145081341511574658757428258020937703703371498976906228288914164074403171127516885244682134581893201619939353 -d 15068042321112867526462984702974425591331013387054874803771174551325191169272934222286923429838517190016285564940444102909894722967170594321296234561555878214662790722139778986642993150247351066556716018540670318075162266386987067615830148984058657107601779624323103828598167804874446125556171982317151069628795881730766508507050086546488486168255147054654869215742344835655651209464741536693683879495214132253161676792000042242056493381821767191198597680361989631398023277123334976217395497331984975242984969749389536074903910847363637405250941578574379399670896086484802141962360839364494811248232660593270356391813 --decryptfile flag.enc
```
Flag:
```
KJSSE_CTF{w3ll_r5a_isn't_s0_s1mple}
```